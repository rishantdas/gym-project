(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4884],{374265:(n,e,a)=>{a.d(e,{Z:()=>t});const t=(0,a(667294).createContext)(!1)},691088:(n,e,a)=>{a.d(e,{Z:()=>C});var t=a(667294),s=a(487889),o=a(648164),i=a(840425),r=a(447474),p=a(681192),d=a(976835),c=a(978143),u=a(645354),m=a(929156),l=a(138064),y=a(757345),b=a(184905),g=a(134578),T=a(278703);const N=(0,l.X)("PwtStopwatch"),I=(n,e)=>{if(m.Z){if("start"===e.type&&!n.isTiming){const{name:a,startTime:t,navigationType:s}=e;return(0,T.A9)(`TIMING.${a}`),{isTiming:!0,name:a,isSampled:e.isSampled,startTime:"number"==typeof t?t:m.Z.now(),metricId:{type:"stopwatch",name:a,navigationType:s},pwtStaticContext:e.pwtStaticContext,annotations:n.annotations,binaryAnnotations:n.binaryAnnotations,spans:n.spans,traceId:n.traceId,spanNameUpdates:n.spanNameUpdates}}if(!n.isTiming){if(!e.bypassIsTimingCheck){const a=e.name||n.name;return N("ignoring action - stopwatch is not actively timing",e),(0,T.A9)(`WARN.${a}.noTiming.${e.type}`),n}N("allowing action while stopwatch is not actively timing (bypassIsTimingCheck is set to true)",e)}if("annotate"===e.type){const a=m.Z.now();return N(`adding annotation {${e.label}: ${a}}`),{...n,annotations:n.annotations.concat([{label:e.label,timestamp:a}])}}if("binaryAnnotate"===e.type)return N(`adding binary annotation {${e.name}: ${String(e.value)}}`),{...n,binaryAnnotations:{...n.binaryAnnotations,[e.name]:{value:e.value,type:e.annotationType}}};if("binaryAnnotateOperation"===e.type){const{value:a,type:t}=e.binaryAnnotationValueAndType;if(n.binaryAnnotations[e.name]){const s=n.binaryAnnotations[e.name].value||0;return N(`operating on binary annotation {\n          name: ${e.name}\n          pervious value: ${String(s)}\n          operand: ${String(a)}\n        }`),{...n,binaryAnnotations:{...n.binaryAnnotations,[e.name]:{value:a?e.operation(s,a):s,type:t}}}}return{...n,binaryAnnotations:{...n.binaryAnnotations,[e.name]:{value:a,type:t}}}}if("addSubspan"===e.type){N(`adding subspan {${e.name}}`);-1!==n.spans.findIndex((n=>n.name===e.name))&&N(`WARNING: adding duplicate subspan name {${e.name}}`);const a=e.id||(0,d.Z)();-1!==n.spans.findIndex((n=>n.id===a))&&N(`WARNING: adding duplicate subspan id {${e.name}: ${a}}`);let t=0;return e.startTime?t=e.startTime:n.startTime?t=n.startTime:N(`WARNING: adding subspan {${e.name}} without start time`),{...n,spans:[...n.spans,{name:e.name,id:a,startTime:t,endTime:e.endTime||1/0,annotationMap:{...e.annotations},binaryAnnotationMap:{...e.binaryAnnotations},parentId:e.parentId}]}}if("subspanStart"===e.type){var a;N(`starting subspan {${e.name}}`);-1!==n.spans.findIndex((n=>n.name===e.name))&&N(`WARNING: starting duplicate subspan name {${e.name}}`);const t=e.id||(0,d.Z)();-1!==n.spans.findIndex((n=>n.id===t))&&N(`WARNING: starting duplicate subspan id {${e.name}: ${t}}`);const s=e.parentName?null===(a=n.spans.find((n=>n.name===e.parentName)))||void 0===a?void 0:a.id:null;return{...n,spans:[...n.spans,{name:e.name,id:t,parentId:e.parentId||s,startTime:m.Z.now(),endTime:1/0,annotationMap:{...e.annotations},binaryAnnotationMap:{...e.binaryAnnotations}}]}}if("subspanStop"===e.type){if(N(`stopping subspan {${e.name}}`),!e.id){n.spans.reduce(((n,a)=>(a.name===e.name&&n.push(a),n)),[]).length>1&&(0,T.H)("duplicate_subspan_stop_name",{name:e.name,type:e.type})}const a=e.id?n.spans.findIndex((n=>n.id===e.id)):n.spans.findIndex((n=>n.name===e.name));return a>-1?(n.spans[a].endTime=m.Z.now(),e.annotations&&(n.spans[a].annotationMap={...n.spans[a].annotationMap,...e.annotations}),e.binaryAnnotations&&(n.spans[a].binaryAnnotationMap={...n.spans[a].binaryAnnotationMap,...e.binaryAnnotations})):(0,T.H)("invalid_subspan_stop_name",{name:e.name}),n}if("subspanUpdateName"===e.type){n.spans.reduce(((n,a)=>(a.name===e.currentName&&n.push(a),n)),[]).length>1&&(0,T.H)("duplicate_subspan_stop_name",{name:e.currentName,type:e.type});const a=n.spans.findIndex((n=>n.name===e.currentName));return a>-1?e.updateWhenStopwatchCompletes?n.spanNameUpdates=[...n.spanNameUpdates,{currentName:e.currentName,newName:e.newName}]:(N(`renaming subspan {${e.currentName}} to {${e.newName}}`),n.spans[a].name=e.newName):(0,T.H)("no_subspan_found_to_rename",{name:e.currentName}),n}if("stop"===e.type&&n.isTiming){const{startTime:a,metricId:t,pwtStaticContext:s,annotations:o,binaryAnnotations:p,isSampled:l,spans:T,traceId:I}=n;if(e.stopwatchPerformanceObserver&&e.stopwatchPerformanceObserver.disconnect(),l){const l=e.stopTime||m.Z.now(),A=[...T.map((e=>{e.endTime===1/0&&(e.endTime=l);const a=n.spanNameUpdates.findIndex((n=>e.name===n.currentName));return a>-1&&(N(`renaming subspan {${e.name}} to {${n.spanNameUpdates[a].newName}}`),e.name=n.spanNameUpdates[a].newName,n.spanNameUpdates=n.spanNameUpdates.filter((n=>n.newName!==e.name))),e}))];if(e.manualAndResourceSpans||0===T.length){const n=(0,d.Z)();A.push({name:"network_resources",id:n,startTime:a,endTime:l,annotationMap:{},binaryAnnotationMap:{},parentId:null},...(e.customStopwatchBuffer||[]).map((e=>(0,u.Z)((0,y.p)(e,[]),n))).filter(Boolean))}const _="initial_app_load"===t.navigationType&&(0,r.Z)(),C={type:"COMPLETE",traceId:I,startTime:a,endTime:l,spans:A,annotationMap:{...(0,i.Z)(o),...(0,g.jh)("browser_",_?(0,g.D3)(_):{})},binaryAnnotationMap:(0,b.ng)({metricId:t,pwtStaticContext:s,binaryAnnotations:p,performanceResourceTimings:e.customStopwatchBuffer||[]})};(0,c.Z)({metricId:t,pwtStaticContext:s,result:C})}return{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,d.Z)(),spanNameUpdates:[]}}if("error"===e.type){const{error:a,stopwatchPerformanceObserver:t}=e;return a&&(0,T.H)(a),t&&t.disconnect(),{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,d.Z)(),spanNameUpdates:[]}}if("abort"===e.type&&n.isTiming){e.stopwatchPerformanceObserver&&e.stopwatchPerformanceObserver.disconnect();const{metricId:a,pwtStaticContext:t}=n,s=e.reason||"";return(0,c.Z)({metricId:a,pwtStaticContext:t,result:{type:"ABORT",reason:s}}),{isTiming:!1,name:n.name,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,d.Z)(),spanNameUpdates:[]}}}return n},A=({name:n,sampleRate:e,navigationType:a,manualAndResourceSpans:s=!1})=>{const i=(0,o.N5)(),r=(0,t.useRef)([]),c=(0,t.useRef)(null),[u,m]=(0,t.useReducer)(I,{isTiming:!1,name:n,annotations:[],binaryAnnotations:{},spans:[],traceId:(0,d.Z)(),spanNameUpdates:[]});return i?{isTiming:u.isTiming,start:t=>{if(window.PerformanceObserver){const n=1e3;r.current=[],c.current=(0,p.Z)({entryTypes:["resource"]},(e=>{r.current=r.current.concat(e.getEntries()),r.current.length>n&&(r.current=r.current.slice(-n))}))}const s={type:"start",startTime:t,name:n,navigationType:a,pwtStaticContext:i,isSampled:!e||Math.random()<e};return m(s)},stop:n=>m({type:"stop",stopTime:n,stopwatchPerformanceObserver:c.current,customStopwatchBuffer:r.current,manualAndResourceSpans:s}),error:n=>{m({type:"error",stopwatchPerformanceObserver:c.current,error:n})},abort:n=>m({type:"abort",stopwatchPerformanceObserver:c.current,customStopwatchBuffer:r.current,reason:n}),annotate:(n,e,a=!1)=>m({type:"annotate",label:n,parentId:e,bypassIsTimingCheck:a}),binaryAnnotate:(n,e,a,t,s=!1)=>m({type:"binaryAnnotate",name:n,value:e,annotationType:a,parentId:t,bypassIsTimingCheck:s}),binaryAnnotateOperation:({name:n,binaryAnnotationValueAndType:e,operation:a,parentId:t,bypassIsTimingCheck:s=!1})=>m({type:"binaryAnnotateOperation",name:n,binaryAnnotationValueAndType:e,operation:a,parentId:t,bypassIsTimingCheck:s}),addSubspan:({name:n,startTime:e,endTime:a,annotations:t={},binaryAnnotations:s={},parentId:o=null,id:i=null,bypassIsTimingCheck:r=!1})=>m({type:"addSubspan",name:n,startTime:e,endTime:a,annotations:t,binaryAnnotations:s,parentId:o,id:i,bypassIsTimingCheck:r}),subspanStart:({name:n,annotations:e={},binaryAnnotations:a={},parentId:t=null,parentName:s=null,id:o=null,bypassIsTimingCheck:i=!1})=>m({type:"subspanStart",name:n,annotations:e,binaryAnnotations:a,parentId:t,parentName:s,id:o,bypassIsTimingCheck:i}),subspanStop:({name:n,annotations:e,binaryAnnotations:a,id:t,parentId:s,bypassIsTimingCheck:o=!1})=>m({type:"subspanStop",name:n,annotations:e,binaryAnnotations:a,id:t,parentId:s,bypassIsTimingCheck:o}),subspanUpdateName:({currentName:n,newName:e,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:t=!0})=>m({type:"subspanUpdateName",currentName:n,newName:e,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:t}),getSpans:(n,e)=>u.spans.filter((a=>a[n]===e)),getTraceId:()=>u.traceId}:null};var _=a(785893);const C=({name:n,v2LoggerMetricName:e,sampleRate:a,abortOnUnloadOrClientNavigation:i=!0,navigationType:r,manualAndResourceSpans:p=!1})=>{const{Provider:d,useMaybeHook:c}=(0,s.Z)(`Stopwatch_${n}`);return{Provider:function({children:e}){const s=A({name:n,sampleRate:a,navigationType:r,manualAndResourceSpans:p}),c=(0,o.fM)(),u=c?c.time:0,m=(0,t.useRef)(!1),l=null==s?void 0:s.isTiming,y=e=>{m.current?(m.current=!1,null==s||s.abort(e)):(0,T.A9)(`WARN.${n}.noTiming.abort`)};return(0,t.useEffect)((()=>()=>{i&&y("unloadOrClientNavigation")}),[u]),(0,_.jsx)(d,{value:{isTiming:l,abort:y,addAnnotation:(n,e)=>{null==s||s.annotate(n,e)},addBinaryAnnotation:(n,e,a,t)=>{null==s||s.binaryAnnotate(n,e,a,t)},binaryAnnotationOperation:({name:n,binaryAnnotationValueAndType:e,operation:a,parentId:t,bypassIsTimingCheck:o})=>{null==s||s.binaryAnnotateOperation({name:n,binaryAnnotationValueAndType:e,operation:a,parentId:t,bypassIsTimingCheck:o})},addSubspan:({name:n,startTime:e,endTime:a,annotations:t,binaryAnnotations:o,parentId:i,id:r,bypassIsTimingCheck:p})=>{null==s||s.addSubspan({name:n,startTime:e,endTime:a,annotations:t,binaryAnnotations:o,parentId:i,id:r,bypassIsTimingCheck:p})},subspanStart:({name:n,annotations:e,binaryAnnotations:a,parentId:t,parentName:o,id:i,bypassIsTimingCheck:r})=>{null==s||s.subspanStart({name:n,annotations:e,binaryAnnotations:a,parentId:t,parentName:o,id:i,bypassIsTimingCheck:r})},subspanStop:({name:n,annotations:e,binaryAnnotations:a,id:t,parentId:o,bypassIsTimingCheck:i})=>{null==s||s.subspanStop({name:n,annotations:e,binaryAnnotations:a,id:t,parentId:o,bypassIsTimingCheck:i})},getSpans:(n,e)=>s?s.getSpans(n,e):[],getTraceId:()=>s?s.getTraceId():0,updateSubspanName:({currentName:n,newName:e,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:t})=>{null==s||s.subspanUpdateName({currentName:n,newName:e,bypassIsTimingCheck:a,updateWhenStopwatchCompletes:t})},error:e=>{m.current?(m.current=!1,null==s||s.error(e)):(0,T.A9)(`WARN.${n}.noTiming.error`)},start:n=>{m.current&&(null==s||s.abort("duplicated_init_stopwatch_action")),m.current=!0,null==s||s.start(n)},stop:e=>{m.current?(m.current=!1,null==s||s.stop(e)):(0,T.A9)(`WARN.${n}.noTiming.stop`)}},children:e})},useHook:c}}},407244:(n,e,a)=>{a.d(e,{i5:()=>A,sX:()=>C,Z5:()=>I,NG:()=>_,MT:()=>S});var t=a(667294),s=a(724207),o=a(276679),i=a(682492),r=a.n(i);const p=(n,e)=>n.data[e]&&n.data[e].messages||[];function d(n,e){const a={};return n.filter((n=>!!n)).reduce(((n,t)=>{const s=e(t);return a[s]?(r()(a[s],t),n):(a[s]=t,n.concat([t]))}),[])}function c(n){return[...n].sort(((n,e)=>new Date(n.created_ms||n.created_at)-new Date(e.created_ms||e.created_at)))}function u(n,e,a){let t=p(n,e).concat(a);return t=d(t,(n=>n.id)),c(t)}const m={conversationsUnseenCount:0,data:{},newsHubCount:0,open:null,showConversationsDropdown:!1,ui:{},unread:0};function l(n=m,e){if("CONVERSATION_OPEN"===e.type)return{...n,open:e.payload.id,ui:{...n.ui,[e.payload.id]:{contactRequestId:e.payload.contactRequestId||"",isPreview:e.payload.isPreview}}};if("CONVERSATION_CLOSE"===e.type)return{...n,open:null,ui:{...n.ui,[e.payload.id]:{contactRequestId:e.payload.contactRequestId||"",isPreview:!1,isDeclined:e.payload.isDeclined}}};if("CONVERSATION_CREATE"===e.type){const{id:a}=e.payload;return{...n,data:{...n.data,[a]:{...n[a]||{},...e.payload}}}}if("CONVERSATION_DELETE"===e.type){const a={...n,data:{...n.data}},{id:t}=e.payload;return delete a.data[t],a}if("FETCH_COMPLETE"===e.type){const{options:a,resource:t,response:s}=e.payload,o=s.resource_response.data;if("ConversationMessagesResource"===t){const e=o||[],t=(null==a?void 0:a.conversation_id)||"",s=u(n,t,e),i=s[s.length-1];return{...n,data:{...n.data,[t]:{...n.data[t],id:t,messages:s,unread:0,last_message:i}}}}if("ConversationsResource"===t){const e=o||[],a={...n,data:{...n.data}};return e.forEach((n=>{const{id:e,created_at:t,name:s,board:o,emails:i,unread:r,users:p,last_message:d}=n,c=u(a,e,[d]);a.data[e]={...a.data[e],id:e,created_at:t,name:s,board:o,emails:i||[],unread:r||0,users:p||[],last_message:d,messages:c}})),a}if("ConversationResource"===t){const e=o||{},{id:a}=e,t={...n,data:{...n.data}};return a&&(t.data[a]={...t.data[a],...e}),t}if("NewsHubBadgeResource"===t){if(o){const e=o.conversations_unseen_count||0;return{...n,unread:e}}return n}}else{if("MESSAGE_SEND_PENDING"===e.type){const{id:a,message:t}=e.payload;if(n.data[a]){const e=u(n,a,[t]);return{...n,data:{...n.data,[a]:{...n.data[a],id:a,messages:e,last_message:t}}}}return n}if("MESSAGE_SEND_PENDING_CLEAR"===e.type){const{id:a,messageId:t,newMessageId:s}=e.payload;if(n.data[a]){const e=p(n,a).find((n=>n.id===t));if(e){const o={...e,id:s};let i=p(n,a).filter((n=>n.id!==t)).concat([o]);return i=d(i,(n=>n.id)),i=c(i),{...n,data:{...n.data,[a]:{...n.data[a],id:a,messages:i}}}}}return n}if("CLOSE_DROPDOWN"===e.type)return{...n,showConversationsDropdown:!1};if("OPEN_DROPDOWN"===e.type)return{...n,showConversationsDropdown:!0};if("UPDATE_NEWSHUB_COUNT"===e.type)return{...n,newsHubCount:e.payload};if("UPDATE_UNREAD_COUNT"===e.type)return{...n,conversationsUnseenCount:e.payload}}return n}var y=a(487889),b=a(657478),g=a(785893);const T=(()=>{let n=0;return()=>n++})(),{Provider:N,useHook:I}=(0,y.Z)("Conversations");function A({children:n}){const[e,a]=(0,t.useReducer)(l,m),o=(0,t.useCallback)((n=>a({type:"FETCH_COMPLETE",payload:n})),[]);(0,b.Z8)("ConversationMessagesResource",o),(0,b.Z8)("ConversationsResource",o),(0,b.Z8)("ConversationResource",o),(0,b.Z8)("NewsHubBadgeResource",o);const i=(0,t.useMemo)((()=>({conversationOpen:(n,e=!1,t="")=>a({type:"CONVERSATION_OPEN",payload:{id:n,isPreview:e,contactRequestId:t}}),conversationClose:(n,e="",t=!1)=>a({type:"CONVERSATION_CLOSE",payload:{id:n,contactRequestId:e,isDeclined:t}}),conversationCreate:n=>a({type:"CONVERSATION_CREATE",payload:n}),conversationDelete:n=>a({type:"CONVERSATION_DELETE",payload:{id:n}}),conversationGet:(n,e,t)=>{s.ZP.create("ConversationsResource",{user_ids:n,emails:e,text:""}).callCreate().then((n=>{const e=n&&n.resource_response.data;a({type:"CONVERSATION_OPEN",payload:{id:e.id}})})).catch((n=>{const e=n.message_detail||n.message||"";t(e)}))},dropdownClose:()=>{a({type:"CLOSE_DROPDOWN"})},dropdownOpen:()=>{a({type:"OPEN_DROPDOWN"})},pendingMessageSend:(n,e)=>a({type:"MESSAGE_SEND_PENDING",payload:{id:n,message:e}}),pendingMessageClear:(n,e,t)=>a({type:"MESSAGE_SEND_PENDING_CLEAR",payload:{id:n,messageId:e,newMessageId:t}}),updateNewsHubCount:n=>a({type:"UPDATE_NEWSHUB_COUNT",payload:n}),updateUnreadCount:n=>a({type:"UPDATE_UNREAD_COUNT",payload:n})})),[]);return(0,g.jsx)(N,{value:{...i,conversations:e},children:n})}function _(){const{conversations:n,conversationCreate:e,pendingMessageSend:a,pendingMessageClear:t}=I(),{pins:i}=(0,o.Wb)();return(o,r,p,d)=>new Promise(((c,u)=>{const{text:m,pinId:l,boardId:y,userId:b,didItId:g}=r;function N(){const n=s.ZP.create("ConversationMessagesResource",{conversation_id:o,text:m,pin:l,board:y,user:b,user_did_it_data:g,source:p}),e=`${T()}`;a(o,{text:m,sender:d,created_at:(new Date).toString(),created_ms:Date.now(),id:e,board:null,event_type:null,pin:l?i[l]:null,type:"message",user_did_it_data:null,user:null}),n.callCreate().then((n=>{t(o,e,n.resource_response.data.id),c()})).catch(u)}n.data[o]?N():s.ZP.create("ConversationResource",{conversation_id:o}).callGet().then((n=>{const a=n&&n.resource_response&&n.resource_response.data;e(a),N()}))}))}function C(n){const{conversations:e}=I();return e.data[n]}function S(n){const{conversations:e}=I();return e.ui[n]||{contactRequestId:"",isDeclined:!1,isPreview:!1}}},877943:(n,e,a)=>{a.d(e,{l:()=>c,E:()=>d});var t=a(667294),s=a(487889);function o(n={},e){if("SUGGESTIONS_FETCH_COMPLETE"===e.type){const{payload:s}=e;if("ShareSuggestionsResource"===s.resource){var a;const t=e.payload.response.resource_response.data||[],{term:o=""}=null!==(a=s.options)&&void 0!==a?a:{};return{...n,[o]:t}}if("ShareSuggestionsTypeaheadResource"===s.resource){var t;const a=(e.payload.response.resource_response.data||{}).items||[],{term:o=""}=null!==(t=s.options)&&void 0!==t?t:{};return{...n,[o]:a}}}return n}var i=a(657478),r=a(785893);const{Provider:p,useHook:d}=(0,s.Z)("ShareSuggestions");function c({children:n}){const[e,a]=(0,t.useReducer)(o,{}),s=n=>{a({type:"SUGGESTIONS_FETCH_COMPLETE",payload:n})};return(0,i.Z8)("ShareSuggestionsResource",s),(0,i.Z8)("ShareSuggestionsTypeaheadResource",s),(0,r.jsx)(p,{value:{shareSuggestions:e},children:n})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/4884-c719d44ac582e546.mjs.map